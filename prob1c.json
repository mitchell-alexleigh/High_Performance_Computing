{"paragraphs":[{"text":"//import dependencies\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.expressions._","user":"anonymous","dateUpdated":"2024-04-24T00:56:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql._\nimport org.apache.spark.sql.expressions._\n"}]},"apps":[],"jobName":"paragraph_1713920175854_-934348063","id":"20240424-005615_1375015495","dateCreated":"2024-04-24T00:56:15+0000","dateStarted":"2024-04-24T00:56:55+0000","dateFinished":"2024-04-24T00:57:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4761"},{"text":"//load data\nval oshWeather_ds = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/Oshkosh/OshkoshWeather.csv\")\n","user":"anonymous","dateUpdated":"2024-04-24T01:44:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"oshWeather_ds: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 14 more fields]\n"}]},"apps":[],"jobName":"paragraph_1713920215381_37020317","id":"20240424-005655_884427572","dateCreated":"2024-04-24T00:56:55+0000","dateStarted":"2024-04-24T01:22:31+0000","dateFinished":"2024-04-24T01:22:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4762"},{"text":"//get needed columns and remove bad data\nval oshWeather_clean = oshWeather_ds.select($\"Year\",$\"Month\",$\"Day\",$\"TimeCST\",$\"TemperatureF\").filter($\"TemperatureF\" > -100)","user":"anonymous","dateUpdated":"2024-04-24T02:03:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"oshWeather_clean: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Year: int, Month: int ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1713922295962_-587470953","id":"20240424-013135_2054356531","dateCreated":"2024-04-24T01:31:35+0000","dateStarted":"2024-04-24T02:03:10+0000","dateFinished":"2024-04-24T02:03:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4763"},{"text":"oshWeather_clean.createOrReplaceTempView(\"oshWeather\")\nval weather_datetime = sqlContext.sql(\"SELECT CONCAT(Year, '-', Month, '-', Day ) AS  weatherDate, TemperatureF FROM oshWeather \")","user":"anonymous","dateUpdated":"2024-04-24T02:19:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"weather_datetime: org.apache.spark.sql.DataFrame = [weatherDate: string, TemperatureF: double]\n"}]},"apps":[],"jobName":"paragraph_1713922506621_30895506","id":"20240424-013506_1792389847","dateCreated":"2024-04-24T01:35:06+0000","dateStarted":"2024-04-24T02:19:36+0000","dateFinished":"2024-04-24T02:19:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4764"},{"text":"//get timestamp\nval weather_stamp = weather_datetime.withColumn(\"timestamp\", unix_timestamp($\"weatherDate\", \"yyyy-MM-dd\"))","user":"anonymous","dateUpdated":"2024-04-24T02:19:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"weather_stamp: org.apache.spark.sql.DataFrame = [weatherDate: string, TemperatureF: double ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1713923212790_268868420","id":"20240424-014652_191953376","dateCreated":"2024-04-24T01:46:52+0000","dateStarted":"2024-04-24T02:19:38+0000","dateFinished":"2024-04-24T02:19:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4765"},{"text":"//create window\nval myWindow = Window.partitionBy(\"weatherDate\").orderBy(\"timestamp\").rangeBetween(0, 7 * 86400)","user":"anonymous","dateUpdated":"2024-04-24T02:20:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myWindow: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@1769a007\n"}]},"apps":[],"jobName":"paragraph_1713924294290_-1108956786","id":"20240424-020454_1176716056","dateCreated":"2024-04-24T02:04:54+0000","dateStarted":"2024-04-24T02:20:14+0000","dateFinished":"2024-04-24T02:20:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4766"},{"text":"//get output of the window function\nval window_out = weather_stamp.withColumn(\"AVG_Temp\", avg($\"TemperatureF\").over(myWindow)).select($\"weatherDate\",$\"AVG_Temp\").dropDuplicates().sort(desc(\"AVG_Temp\"))","user":"anonymous","dateUpdated":"2024-04-24T02:48:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"window_out: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [weatherDate: string, AVG_Temp: double]\n"}]},"apps":[],"jobName":"paragraph_1713924585118_1816302781","id":"20240424-020945_2076613575","dateCreated":"2024-04-24T02:09:45+0000","dateStarted":"2024-04-24T02:40:01+0000","dateFinished":"2024-04-24T02:40:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4767"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1713924744386_-809791828","id":"20240424-021224_728041404","dateCreated":"2024-04-24T02:12:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4768","text":"//show final results with the time frame for hottest average temp \nwindow_out.withColumn(\"start_Date\",$\"weatherDate\").withColumn(\"end_Date\",date_add($\"weatherDate\", 7)).select($\"start_date\", $\"end_date\",$\"AVG_Temp\").show(1)  ","dateUpdated":"2024-04-24T02:44:58+0000","dateFinished":"2024-04-24T02:45:03+0000","dateStarted":"2024-04-24T02:44:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+----------+-----------------+\n|start_date|  end_date|         AVG_Temp|\n+----------+----------+-----------------+\n|  2012-7-5|2012-07-12|87.05384615384614|\n+----------+----------+-----------------+\nonly showing top 1 row\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1713926676836_1416736377","id":"20240424-024436_450115020","dateCreated":"2024-04-24T02:44:36+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5272"}],"name":"prob1c","id":"2JWDCAMEG","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}