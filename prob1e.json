{"paragraphs":[{"text":"//import dependencies\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.expressions._","user":"anonymous","dateUpdated":"2024-04-28T23:04:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql._\nimport org.apache.spark.sql.expressions._\n"}]},"apps":[],"jobName":"paragraph_1714341180744_1574139027","id":"20240428-215300_1354145667","dateCreated":"2024-04-28T21:53:00+0000","dateStarted":"2024-04-28T23:04:57+0000","dateFinished":"2024-04-28T23:05:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:158"},{"text":"//load data\nval oshWeather_ds = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/Oshkosh/OshkoshWeather.csv\")\nval iowaWeather_ds = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/IowaCity/IowaCityWeather.csv\")","user":"anonymous","dateUpdated":"2024-04-28T23:04:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"oshWeather_ds: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 14 more fields]\niowaWeather_ds: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 14 more fields]\n"}]},"apps":[],"jobName":"paragraph_1714341208198_647324900","id":"20240428-215328_78486126","dateCreated":"2024-04-28T21:53:28+0000","dateStarted":"2024-04-28T23:04:58+0000","dateFinished":"2024-04-28T23:05:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:159"},{"text":"//get needed columns and remove bad data\nval oshWeather_clean = oshWeather_ds.select($\"Year\",$\"Month\",$\"Day\",$\"TimeCST\",$\"TemperatureF\").filter($\"TemperatureF\" > -100)\nval iowaWeather_clean = iowaWeather_ds.select($\"Year\",$\"Month\",$\"Day\",$\"TimeCST\",$\"TemperatureF\").filter($\"TemperatureF\" > -100)","user":"anonymous","dateUpdated":"2024-04-28T23:04:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"oshWeather_clean: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Year: int, Month: int ... 3 more fields]\niowaWeather_clean: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Year: int, Month: int ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1714341372455_-1409529041","id":"20240428-215612_1042514485","dateCreated":"2024-04-28T21:56:12+0000","dateStarted":"2024-04-28T23:05:00+0000","dateFinished":"2024-04-28T23:05:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:160"},{"text":"//combine data sets and get date and timestamp columns \noshWeather_clean.createOrReplaceTempView(\"oshWeather\")\niowaWeather_clean.createOrReplaceTempView(\"iowaWeather\")\nval weather_datetime = sqlContext.sql(\"SELECT 'Oshkosh' AS city, CONCAT(Year, '-', Month, '-', Day, ' ', timeCST ) AS  weatherDate, TemperatureF FROM oshWeather UNION SELECT  'Iowa City' AS city, CONCAT(Year, '-', Month, '-', Day, ' ', timeCST ) AS  weatherDate, TemperatureF FROM iowaWeather\")\nval weather_stamp = weather_datetime.withColumn(\"timestamp\", unix_timestamp($\"weatherDate\", \"yyyy-MM-dd hh:mm a\"))","user":"anonymous","dateUpdated":"2024-04-28T23:04:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"weather_datetime: org.apache.spark.sql.DataFrame = [city: string, weatherDate: string ... 1 more field]\nweather_stamp: org.apache.spark.sql.DataFrame = [city: string, weatherDate: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1714341434475_-1754756073","id":"20240428-215714_761370621","dateCreated":"2024-04-28T21:57:14+0000","dateStarted":"2024-04-28T23:05:26+0000","dateFinished":"2024-04-28T23:05:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:161"},{"text":"//create window\nval myWindow = Window.partitionBy(\"city\").orderBy(\"timestamp\").rangeBetween(0,86400)","user":"anonymous","dateUpdated":"2024-04-28T23:04:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myWindow: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@1511fc90\n"}]},"apps":[],"jobName":"paragraph_1714341738730_-1177988468","id":"20240428-220218_1810672139","dateCreated":"2024-04-28T22:02:18+0000","dateStarted":"2024-04-28T23:05:29+0000","dateFinished":"2024-04-28T23:05:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:162"},{"text":"//get output of the window function\nval window_out = weather_stamp.withColumn(\"minTemp\", min($\"TemperatureF\").over(myWindow)).withColumn(\"maxTemp\", max($\"TemperatureF\").over(myWindow))\nwindow_out.show()","user":"anonymous","dateUpdated":"2024-04-28T23:11:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"window_out: org.apache.spark.sql.DataFrame = [city: string, weatherDate: string ... 4 more fields]\n+-------+-----------------+------------+---------+-------+-------+\n|   city|      weatherDate|TemperatureF|timestamp|minTemp|maxTemp|\n+-------+-----------------+------------+---------+-------+-------+\n|Oshkosh|2000-1-1 12:53 AM|        35.1|946687980|   28.0|   36.0|\n|Oshkosh| 2000-1-1 1:53 AM|        35.1|946691580|   28.0|   36.0|\n|Oshkosh| 2000-1-1 2:53 AM|        35.1|946695180|   28.0|   36.0|\n|Oshkosh| 2000-1-1 3:53 AM|        34.0|946698780|   28.0|   36.0|\n|Oshkosh| 2000-1-1 4:53 AM|        32.0|946702380|   28.0|   37.4|\n|Oshkosh| 2000-1-1 5:53 AM|        30.9|946705980|   28.0|   37.4|\n|Oshkosh| 2000-1-1 6:53 AM|        28.0|946709580|   28.0|   37.4|\n|Oshkosh| 2000-1-1 7:53 AM|        28.0|946713180|   28.0|   37.4|\n|Oshkosh| 2000-1-1 8:53 AM|        28.0|946716780|   28.0|   37.4|\n|Oshkosh| 2000-1-1 9:53 AM|        33.1|946720380|   30.2|   37.4|\n|Oshkosh|2000-1-1 10:53 AM|        34.0|946723980|   30.2|   37.4|\n|Oshkosh|2000-1-1 11:53 AM|        36.0|946727580|   30.2|   37.4|\n|Oshkosh|2000-1-1 12:53 PM|        35.1|946731180|   30.2|   37.4|\n|Oshkosh| 2000-1-1 1:53 PM|        34.0|946734780|   30.2|   37.4|\n|Oshkosh| 2000-1-1 2:53 PM|        33.1|946738380|   30.2|   37.4|\n|Oshkosh| 2000-1-1 3:53 PM|        32.0|946741980|   30.2|   37.4|\n|Oshkosh| 2000-1-1 4:53 PM|        32.0|946745580|   30.2|   37.4|\n|Oshkosh| 2000-1-1 5:53 PM|        32.0|946749180|   30.2|   37.4|\n|Oshkosh| 2000-1-1 6:37 PM|        32.0|946751820|   30.2|   37.4|\n|Oshkosh| 2000-1-1 6:53 PM|        32.0|946752780|   30.2|   37.4|\n+-------+-----------------+------------+---------+-------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1714341824618_-894322904","id":"20240428-220344_1606890817","dateCreated":"2024-04-28T22:03:44+0000","dateStarted":"2024-04-28T23:11:48+0000","dateFinished":"2024-04-28T23:12:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:163"},{"text":"window_out.createOrReplaceTempView(\"window_out\")\nval result_prep =  sqlContext.sql(\"SELECT city,minTemp, maxTemp,max( CASE WHEN TemperatureF = minTemp THEN timestamp END) AS minTempStamp, min( CASE WHEN TemperatureF = maxTemp THEN timestamp END) AS maxTempStamp FROM window_out wo GROUP BY  city,minTemp, maxTemp \")  \nresult_prep.show()","user":"anonymous","dateUpdated":"2024-04-28T23:28:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"result_prep: org.apache.spark.sql.DataFrame = [city: string, minTemp: double ... 3 more fields]\n+-------+-------+-------+------------+------------+\n|   city|minTemp|maxTemp|minTempStamp|maxTempStamp|\n+-------+-------+-------+------------+------------+\n|Oshkosh|   28.0|   36.0|  1451080380|   946788780|\n|Oshkosh|   28.0|   37.4|  1297759980|   946787940|\n|Oshkosh|   30.2|   37.4|  1293623580|  1014153840|\n|Oshkosh|   30.9|   37.4|  1449392880|  1067991720|\n|Oshkosh|   30.0|   37.4|  1449381180|  1014159780|\n|Oshkosh|   28.9|   37.4|  1198140780|  1070986320|\n|Oshkosh|   28.0|   35.6|  1360749180|   946796460|\n|Oshkosh|   28.0|   35.1|  1418367180|   946799580|\n|Oshkosh|   28.0|   34.0|  1422005400|   946803180|\n|Oshkosh|   28.0|   33.8|  1363261980|   946822920|\n|Oshkosh|   26.6|   33.8|  1260268440|   946837080|\n|Oshkosh|   26.6|   32.0|  1266744060|   946838520|\n|Oshkosh|   24.8|   30.9|  1041734400|   946846380|\n|Oshkosh|   24.1|   30.9|  1419059040|   946849980|\n|Oshkosh|   23.0|   30.9|  1353747180|   946853580|\n|Oshkosh|   21.9|   28.4|  1323161580|   946922820|\n|Oshkosh|   21.0|   26.6|  1262821980|   946926720|\n|Oshkosh|   19.0|   26.6|  1262778780|  1014675900|\n|Oshkosh|   15.1|   26.6|  1291355580|  1200255360|\n|Oshkosh|    6.1|   26.6|        null|   946971120|\n+-------+-------+-------+------------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1714342044308_-21557512","id":"20240428-220724_136631194","dateCreated":"2024-04-28T22:07:24+0000","dateStarted":"2024-04-28T23:28:48+0000","dateFinished":"2024-04-28T23:29:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:164"},{"text":"result_prep.createOrReplaceTempView(\"result_prep\")\nval final_output = sqlContext.sql(\"SELECT City, maxTemp-minTemp AS  tempDiff, maxTempStamp-minTempStamp AS timeDiff FROM result_prep WHERE maxTempStamp IS NOT NULL AND minTempStamp IS NOT NULL ORDER BY tempDiff DESC,timeDiff LIMIT 1 \")\nfinal_output.show()","user":"anonymous","dateUpdated":"2024-04-28T23:32:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"final_output: org.apache.spark.sql.DataFrame = [City: string, tempDiff: double ... 1 more field]\n+---------+--------+----------+\n|     City|tempDiff|  timeDiff|\n+---------+--------+----------+\n|Iowa City|    43.1| 439819140|\n|Iowa City|    40.0|-157809600|\n+---------+--------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1714343176729_-1415727183","id":"20240428-222616_844608365","dateCreated":"2024-04-28T22:26:16+0000","dateStarted":"2024-04-28T23:31:23+0000","dateFinished":"2024-04-28T23:31:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165"},{"text":"","user":"anonymous","dateUpdated":"2024-04-28T23:07:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-------+--------+-----------------------------+\n|     city|maxTemp|tempDiff|(maxTempStamp - minTempStamp)|\n+---------+-------+--------+-----------------------------+\n|Iowa City|   -0.9|   -24.0|                         null|\n|Iowa City|    1.0|   -24.0|                         null|\n+---------+-------+--------+-----------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1714344098262_1737039933","id":"20240428-224138_2031929112","dateCreated":"2024-04-28T22:41:38+0000","dateStarted":"2024-04-28T23:05:38+0000","dateFinished":"2024-04-28T23:06:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:166"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1714344137114_1282913637","id":"20240428-224217_439922317","dateCreated":"2024-04-28T22:42:17+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:167"}],"name":"prob1e","id":"2JYDFZ3P4","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}